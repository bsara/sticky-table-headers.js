/*!
 * sticky-table-headers.js (0.0.1)
 *
 * Copyright (c) 2015 Brandon Sara (http://bsara.github.io)
 * Licensed under the CPOL-1.02 (https://github.com/bsara/stickytableheaders.js/blob/v0.0.1/LICENSE.md)
 */
!function(e,t){"function"==typeof define&&define.amd?define(t):"object"==typeof exports?module.exports=t(require,exports,module):e.STH=t()}(this,function(e,t,l){var r={constants:{CSS_CLASS_NAME:"sth-sticky",SCROLLABLE_ELEMENT_SELECTOR_ATTR_NAME:"data-sth-scrollable-selector"},helpers:{addEventListener:function(e,t,l){return e.attachEvent?void e.attachEvent("on"+t,l):void e.addEventListener(t,l,!1)},removeEventListener:function(e,t,l){return e.detachEvent?void e.detachEvent("on"+t):void e.removeEventListener(t,l)},removeUnit:function(e){if("string"!=typeof e||null===e)throw new TypeError("`value` argument must be a non-null string!");return""===e.trim()?0:Number(e.trim().replace(/[a-z]*$/i,""))}}};Object.freeze(r);var n=function(){function e(o,h){if(null==o)throw new TypeError("`tableElement` is a required parameter!");return this.constructor!==e?new e(o,h):(Object.defineProperties(this,{_onChangeTableChildrenObserver:{configurable:!0,enumerable:!1,writable:!0,value:void 0},_onChangeTableScrollableElementSelectorObserver:{configurable:!0,enumerable:!1,writable:!0,value:void 0},_onChange:{configurable:!1,enumerable:!1,writable:!1,value:i.bind(this)}}),this.$table=o,this.$tableHeader=void 0,this.$scrollable=void 0,this.$table.classList.contains(r.constants.CSS_CLASS_NAME)||this.$table.classList.add(r.constants.CSS_CLASS_NAME),t.call(this,this.$table.querySelector("thead")),null==h?l.call(this):n.call(this,h),this._onChangeTableChildrenObserver=new MutationObserver(a.bind(this)),this._onChangeTableChildrenObserver.observe(this.$table,{childList:!0}),this._onChangeTableScrollableElementSelectorObserver=new MutationObserver(s.bind(this)),void this._onChangeTableScrollableElementSelectorObserver.observe(this.$table,{attributes:!0}))}e.prototype.destroy=function(){this._onChangeTableChildrenObserver.disconnect(),this._onChangeTableScrollableElementSelectorObserver.disconnect(),r.helpers.removeEventListener(window,"resize",this._onChange),null!=this.$scrollable&&r.helpers.removeEventListener(this.$scrollable,"scroll",this._onChange),this.$table.classList.remove(r.constants.CSS_CLASS_NAME),null!=this.$tableHeader&&this.$tableHeader.classList.remove(r.constants.CSS_CLASS_NAME),delete this.$table,delete this.$tableHeader,delete this.$scrollable,delete this._onChangeTableChildrenObserver,delete this._onChangeTableScrollableElementSelectorObserver,delete this._onChange};var t=function(e){this.$tableHeader=e,null!=this.$tableHeader},l=function(){var e=this.$table.getAttribute(r.constants.SCROLLABLE_ELEMENT_SELECTOR_ATTR_NAME);null!=e&&"string"==typeof e&&e.trim()&&n.call(this,document.querySelector(e.trim())),null==this.$scrollable&&n.call(this,this.$table.parentNode)},n=function(e){return this.$scrollable=e,null!=this.$scrollable?(r.helpers.addEventListener(this.$scrollable,"scroll",this._onChange),void r.helpers.addEventListener(window,"resize",this._onChange)):void r.helpers.removeEventListener(window,"resize",this._onChange)},i=function(){if(null!=this.$tableHeader){var e=this.$scrollable.getBoundingClientRect().top;if(this.$table.getBoundingClientRect().top<e){var t=this.$table.getBoundingClientRect(),l=r.helpers.removeUnit(window.getComputedStyle(this.$table,null).getPropertyValue("border-left-width")),n=window.getComputedStyle(this.$tableHeader,null),i=r.helpers.removeUnit(n.getPropertyValue("border-top-width")),a=r.helpers.removeUnit(n.getPropertyValue("border-left-width")),s=r.helpers.removeUnit(n.getPropertyValue("border-right-width"));this.$tableHeader.style.top=e-t.top+i+"px",this.$tableHeader.style.left=a-l+"px",this.$tableHeader.style.width="calc(100% + "+s+"px)";for(var o=this.$tableHeader.querySelectorAll("th"),h=this.$table.querySelectorAll("tbody > tr td"),d=null==h||0===h.length,c=100/o.length+"%",b=0;b<o.length;b++){var u=o[b];d?u.style.width=c:u.style.width=window.getComputedStyle(h[b],void 0).getPropertyValue("width")}return void this.$tableHeader.classList.add(r.constants.CSS_CLASS_NAME)}this.$tableHeader.classList.remove(r.constants.CSS_CLASS_NAME),this.$tableHeader.removeAttribute("style")}},a=function(e){e.forEach(function(e){var l;for(l=0;l<e.addedNodes.length;l++)if("thead"===e.addedNodes[l].nodeName){t.call(this,e.addedNodes[l]);break}for(l=0;l<e.removedNodes.length;l++)if("thead"===e.removedNodes[l].nodeName){t.call(this,void 0);break}})},s=function(e){e.forEach(function(e){e.attributeName===r.constants.SCROLLABLE_ELEMENT_SELECTOR_ATTR_NAME&&l.call(this)})};return e}(),i=function(){function e(){return this.constructor!==e?new e:void Object.defineProperties(this,{_stickyTableHeaders:{configurable:!0,enumerable:!1,writable:!0,value:[]},_tableElements:{configurable:!0,enumerable:!1,writable:!0,value:[]}})}e.prototype.init=function(){for(var e=document.querySelectorAll("table."+r.constants.CSS_CLASS_NAME),l=0;l<e.length;l++)t.call(this,e[l])},e.prototype.reinit=function(){this.removeAll(),this.init()},e.prototype.removeAll=function(){for(var e=this._tableElements.length;e>=0;e--)l.call(this,e)},e.prototype.addStickyHeaderToTable=function(e,l){return this._tableElements.indexOf(e)>-1?e:(t.call(this,e,l),e)},e.prototype.removeStickyHeaderFromTable=function(e){var t=this._tableElements.indexOf(e);t>-1&&l.call(this,t)};var t=function(e,t){this._stickyTableHeaders.push(new n(e,t)),this._tableElements.push(e)},l=function(e){this._stickyTableHeaders.splice(e,1)[0].destroy(),this._tableElements.splice(e,1)};return e}();new i;return function(){var e={};return Object.defineProperties(e,{manager:{configurable:!1,enumerable:!0,writable:!1,value:new i},StickyTableHeader:{configurable:!1,enumerable:!0,writable:!1,value:n}}),e}()});