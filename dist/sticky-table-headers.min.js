/*!
 * sticky-table-headers.js (0.2.2)
 *
 * Copyright (c) 2017 Brandon Sara (http://bsara.github.io)
 * Licensed under the CPOL-1.02 (https://github.com/bsara/stickytableheaders.js/blob/v0.2.2/LICENSE.md)
 */
!function(e,t){"function"==typeof define&&define.amd?define(t):"object"==typeof exports?module.exports=t(require,exports,module):e.STH=t()}(this,function(e,t,n){function r(e,t){function n(){C.disconnect(),A.disconnect(),a.helpers.removeEventListener(window,"resize",_),null!=this.$scrollable&&a.helpers.removeEventListener(this.$scrollable,"scroll",_),this.$table.classList.remove(a.constants.CSS_CLASS_NAME),null!=H&&H.classList.remove(a.constants.CSS_CLASS_NAME),C=void 0,A=void 0,R=void 0,P=void 0,H=void 0}function i(){return M}function l(e){M=e===!0}function o(){return R}function s(e){if(null==e)throw new ReferenceError("`$table` cannot be `null` or `undefined`.");R=e,R.classList.contains(a.constants.CSS_CLASS_NAME)||R.classList.add(a.constants.CSS_CLASS_NAME),v.call(this,R.querySelector("caption")),p.call(this,R.querySelector("thead"))}function c(){return P}function u(e){null==e?h.call(this):d.call(this,e),null==P&&d.call(this,f(this.$table))}function d(e){e!==P&&(null!=P&&(a.helpers.removeEventListener(P,"scroll",_),a.helpers.removeEventListener(window,"resize",_)),P=e,null!=P&&(a.helpers.addEventListener(P,"scroll",_),a.helpers.addEventListener(window,"resize",_)))}function h(){var e=this.$table.getAttribute(a.constants.SCROLLABLE_ELEMENT_SELECTOR_ATTR_NAME);null!=e&&"string"==typeof e&&e.trim()&&d.call(this,document.querySelector(e.trim()))}function f(e){if(null==e.parentNode)return e;var t=e.parentNode,n=getComputedStyle(t);switch(n.overflowY){case"auto":case"scroll":return t}return f(t)}function v(e){O=e}function p(e){H=e}function b(){if(null!=H){var e,t,n,r=null!=O,i=this.$table.getBoundingClientRect().top,l=H.querySelectorAll("th"),o=getComputedStyle(H),s=a.helpers.removeUnit(o.getPropertyValue("margin-top")),c=a.helpers.removeUnit(getComputedStyle(this.$scrollable).getPropertyValue("border-top-width")),u=this.$scrollable.getBoundingClientRect().top,d=i;if(r&&(e=getComputedStyle(O),t=O.getBoundingClientRect(),n=a.helpers.removeUnit(e.getPropertyValue("margin-bottom")),d+=a.helpers.removeUnit(e.getPropertyValue("margin-top")),this.includeCaption||(d+=t.height+n)),this.includeCaption||(d+=s),d<u)return r&&this.includeCaption?(m(O,u,c,i),E(O,e),H.style.top=a.helpers.removeUnit(e.getPropertyValue("top"))+t.height+n+s+"px"):m(H,u,c,i),E(H,o),g.call(this,l),r&&this.includeCaption&&O.classList.add(a.constants.CSS_CLASS_NAME),void H.classList.add(a.constants.CSS_CLASS_NAME);r&&this.includeCaption&&y(O),y(H),S(l)}}function m(e,t,n,r){e.style.top=t-r+n+"px"}function E(e,t){var n=a.helpers.removeUnit(t.getPropertyValue("margin-right")),r=a.helpers.removeUnit(t.getPropertyValue("border-right-width"));e.style.left=t.getPropertyValue("margin-left"),e.style.right=n-r+"px"}function g(e){for(var t=this.$table.querySelectorAll("tbody > tr td"),n=null==t||0===t.length,r=100/e.length+"%",i=0===$.length,l=0;l<e.length;l++){var o=e[l];if(i&&$.push({width:o.style.getPropertyValue("width"),priority:o.style.getPropertyPriority("width")}),n)o.style.width=r;else{var s=a.helpers.removeUnit(getComputedStyle(t[l]).getPropertyValue("width"));o.style.width=s+"px";var c=o.getBoundingClientRect().width;c<s?o.style.width=s+(s-c)+"px":c>s&&(o.style.width=s-(c-s)+"px")}}}function y(e){e.classList.remove(a.constants.CSS_CLASS_NAME),e.removeAttribute("style")}function S(e){if(0!==$.length){for(var t=0;t<e.length;t++){var n=e[t],r=$[t];null!=r.width?n.style.setProperty("width",r.width,r.priority):n.style.removeProperty("width")}$.splice(0,$.length)}}function L(e){e.forEach(function(e){var t;for(t=0;t<e.addedNodes.length;t++)if("thead"===e.addedNodes[t].nodeName){p.call(this,e.addedNodes[t]);break}for(t=0;t<e.removedNodes.length;t++)if("thead"===e.removedNodes[t].nodeName){p.call(this,void 0);break}})}function w(e){e.forEach(function(e){e.attributeName===a.constants.SCROLLABLE_ELEMENT_SELECTOR_ATTR_NAME&&h.call(this)})}if(this.constructor!==r)return new r(e,t);var C,A,_,N,T,M,$,P,R,O,H;(function(){this.destroy=n.bind(this),Object.defineProperties(this,{includeCaption:{get:i,set:l},$scrollable:{get:c,set:u},$table:{get:o,set:s}}),_=b.bind(this),N=L.bind(this),T=w.bind(this),e=e||{},e instanceof HTMLElement&&(e={tableElement:e}),$=[],this.includeCaption=e.includeCaption,this.$table=e.tableElement,this.$scrollable=t||e.scrollableElement,C=new MutationObserver(N),C.observe(this.$table,{childList:!0}),A=new MutationObserver(T),A.observe(this.$table,{attributes:!0})}).call(this)}function i(){function e(){for(var e=document.querySelectorAll("table."+a.constants.CSS_CLASS_NAME),t=0;t<e.length;t++)this.add(e[t])}function t(){this.removeAll(),this.init()}function n(e,t){return c.indexOf(e)>-1?e:(l(e,t),c.push(e),e)}function r(e){var t=c.indexOf(e);return t>-1&&(o(e),c.splice(t,1)),e}function s(){for(var e=c.length;e>=0;e--)this.remove(e)}if(this.constructor!==i)return new i;var c;(function(){this.init=e,this.reinit=t,this.add=n,this.remove=r,this.removeAll=s,c=[]}).call(this)}function l(e,t){return s("tableElement",e),s("scrollableElement",t,!0),null!=e.stickyTableHeader?e:(e.stickyTableHeader=new r(e,t),e)}function o(e){return s("tableElement",e),null==e.stickyTableHeader?e:(e.stickyTableHeader.destroy(),delete e.stickyTableHeader,e)}function s(e,t,n){if(n!==!0&&null==t)throw new ReferenceError("`"+e+"` parameter cannot be `null` or `undefined`.");if(n===!0&&null!=t&&!(t instanceof HTMLElement))throw new TypeError("`"+e+"` parameter must be an `HTMLElement`, but a `"+t.constructor.name+"` was given.")}var a={constants:{CSS_CLASS_NAME:"sth-sticky",SCROLLABLE_ELEMENT_SELECTOR_ATTR_NAME:"data-sth-scrollable-selector"},helpers:{addEventListener:function(e,t,n){return e.attachEvent?void e.attachEvent("on"+t,n):void e.addEventListener(t,n,!1)},removeEventListener:function(e,t,n){return e.detachEvent?void e.detachEvent("on"+t):void e.removeEventListener(t,n)},removeUnit:function(e){if(null==e||"string"!=typeof e)throw new TypeError("`value` parameter must be a non-null/non-undefined string!");return""===e.trim()?0:Number(e.trim().replace(/[a-z]*$/i,""))}}};Object.freeze(a);var c=new i;return function(){var e={};return Object.defineProperties(e,{disableStickyTableHeader:{configurable:!1,enumerable:!0,writable:!1,value:o},enableStickyTableHeader:{configurable:!1,enumerable:!0,writable:!1,value:l},manager:{configurable:!1,enumerable:!0,writable:!1,value:c},StickyTableHeader:{configurable:!1,enumerable:!0,writable:!1,value:r}}),e}()});