/*!
 * sticky-table-headers.js (0.2.0)
 *
 * Copyright (c) 2016 Brandon Sara (http://bsara.github.io)
 * Licensed under the CPOL-1.02 (https://github.com/bsara/stickytableheaders.js/blob/v0.2.0/LICENSE.md)
 */
!function(e,t){"function"==typeof define&&define.amd?define(t):"object"==typeof exports?module.exports=t(require,exports,module):e.STH=t()}(this,function(e,t,n){function r(e,t){function n(){S.disconnect(),g.disconnect(),s.helpers.removeEventListener(window,"resize",y),null!=this.$scrollable&&s.helpers.removeEventListener(this.$scrollable,"scroll",y),this.$table.classList.remove(s.constants.CSS_CLASS_NAME),null!=N&&N.classList.remove(s.constants.CSS_CLASS_NAME),S=void 0,g=void 0,_=void 0,A=void 0,N=void 0}function i(){return w}function l(e){w=e===!0}function o(){return _}function a(e){if(null==e)throw new ReferenceError("`$table` cannot be `null` or `undefined`.");_=e,_.classList.contains(s.constants.CSS_CLASS_NAME)||_.classList.add(s.constants.CSS_CLASS_NAME),v.call(this,_.querySelector("caption")),b.call(this,_.querySelector("thead"))}function c(){return A}function u(e){null==e?h.call(this):d.call(this,e),null==A&&d.call(this,f(this.$table))}function d(e){e!==A&&(null!=A&&(s.helpers.removeEventListener(A,"scroll",y),s.helpers.removeEventListener(window,"resize",y)),A=e,null!=A&&(s.helpers.addEventListener(A,"scroll",y),s.helpers.addEventListener(window,"resize",y)))}function h(){var e=this.$table.getAttribute(s.constants.SCROLLABLE_ELEMENT_SELECTOR_ATTR_NAME);null!=e&&"string"==typeof e&&e.trim()&&d.call(this,document.querySelector(e.trim()))}function f(e){if(null==e.parentNode)return e;var t=e.parentNode,n=getComputedStyle(t);switch(n.overflowY){case"auto":case"scroll":return t}return f(t)}function v(e){T=e}function b(e){N=e}function m(){if(null!=N){var e=Math.floor(this.$scrollable.getBoundingClientRect().top),t=Math.floor(this.$table.getBoundingClientRect().top);if(this.includeCaption||null==T||(t+=Math.floor(T.getBoundingClientRect().height)+s.helpers.removeUnit(getComputedStyle(T).getPropertyValue("marginBottom"))),this.includeCaption&&null!=T||(t+=s.helpers.removeUnit(getComputedStyle(N).getPropertyValue("marginTop"))),e>=t){var n=N.getBoundingClientRect(),r=s.helpers.removeUnit(getComputedStyle(this.$table).getPropertyValue("border-left-width")),i=getComputedStyle(N),l=s.helpers.removeUnit(i.getPropertyValue("border-top-width")),o=s.helpers.removeUnit(i.getPropertyValue("border-left-width")),a=s.helpers.removeUnit(i.getPropertyValue("border-right-width"));N.style.top=e-n.top+l+"px",N.style.left=o-r+"px",N.style.width="calc(100% + "+a+"px)";for(var c=N.querySelectorAll("th"),u=this.$table.querySelectorAll("tbody > tr td"),d=null==u||0===u.length,h=100/c.length+"%",f=0;f<c.length;f++){var v=c[f];d?v.style.width=h:v.style.width=getComputedStyle(u[f]).getPropertyValue("width")}return void N.classList.add(s.constants.CSS_CLASS_NAME)}N.classList.remove(s.constants.CSS_CLASS_NAME),N.removeAttribute("style")}}function p(e){e.forEach(function(e){var t;for(t=0;t<e.addedNodes.length;t++)if("thead"===e.addedNodes[t].nodeName){b.call(this,e.addedNodes[t]);break}for(t=0;t<e.removedNodes.length;t++)if("thead"===e.removedNodes[t].nodeName){b.call(this,void 0);break}})}function E(e){e.forEach(function(e){e.attributeName===s.constants.SCROLLABLE_ELEMENT_SELECTOR_ATTR_NAME&&h.call(this)})}if(this.constructor!==r)return new r(e,t);var S,g,y,L,C,w,A,_,T,N;(function(){this.destroy=n.bind(this),Object.defineProperties(this,{includeCaption:{get:i,set:l},$scrollable:{get:c,set:u},$table:{get:o,set:a}}),y=m.bind(this),L=p.bind(this),C=E.bind(this),e=e||{},e instanceof HTMLElement&&(e={tableElement:e}),this.includeCaption=e.includeCaption,this.$table=e.tableElement,this.$scrollable=t||e.scrollableElement,S=new MutationObserver(L),S.observe(this.$table,{childList:!0}),g=new MutationObserver(C),g.observe(this.$table,{attributes:!0})}).call(this)}function i(){function e(){for(var e=document.querySelectorAll("table."+s.constants.CSS_CLASS_NAME),t=0;t<e.length;t++)this.add(e[t])}function t(){this.removeAll(),this.init()}function n(e,t){return c.indexOf(e)>-1?e:(l(e,t),c.push(e),e)}function r(e){var t=c.indexOf(e);return t>-1&&(o(e),c.splice(t,1)),e}function a(){for(var e=c.length;e>=0;e--)this.remove(e)}if(this.constructor!==i)return new i;var c;(function(){this.init=e,this.reinit=t,this.add=n,this.remove=r,this.removeAll=a,c=[]}).call(this)}function l(e,t){return a("tableElement",e),a("scrollableElement",t,!0),null!=e.stickyTableHeader?e:(e.stickyTableHeader=new r(e,t),e)}function o(e){return a("tableElement",e),null==e.stickyTableHeader?e:(e.stickyTableHeader.destroy(),delete e.stickyTableHeader,e)}function a(e,t,n){if(n!==!0&&null==t)throw new ReferenceError("`"+e+"` parameter cannot be `null` or `undefined`.");if(n===!0&&null!=t&&!(t instanceof HTMLElement))throw new TypeError("`"+e+"` parameter must be an `HTMLElement`, but a `"+t.constructor.name+"` was given.")}var s={constants:{CSS_CLASS_NAME:"sth-sticky",SCROLLABLE_ELEMENT_SELECTOR_ATTR_NAME:"data-sth-scrollable-selector"},helpers:{addEventListener:function(e,t,n){return e.attachEvent?void e.attachEvent("on"+t,n):void e.addEventListener(t,n,!1)},removeEventListener:function(e,t,n){return e.detachEvent?void e.detachEvent("on"+t):void e.removeEventListener(t,n)},removeUnit:function(e){if(null==e||"string"!=typeof e)throw new TypeError("`value` parameter must be a non-null/non-undefined string!");return""===e.trim()?0:Number(e.trim().replace(/[a-z]*$/i,""))}}};Object.freeze(s);var c=new i;return function(){var e=function(){c.init()};"loading"!==document.readyState?e():document.addEventListener?document.addEventListener("DOMContentLoaded",e):document.attachEvent("onreadystatechange",function(){"complete"===document.readyState&&e()})}(),function(){var e={};return Object.defineProperties(e,{disableStickyTableHeader:{configurable:!1,enumerable:!0,writable:!1,value:o},enableStickyTableHeader:{configurable:!1,enumerable:!0,writable:!1,value:l},manager:{configurable:!1,enumerable:!0,writable:!1,value:c},StickyTableHeader:{configurable:!1,enumerable:!0,writable:!1,value:r}}),e}()});