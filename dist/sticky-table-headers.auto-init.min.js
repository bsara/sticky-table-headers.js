/*!
 * sticky-table-headers.js (0.2.0)
 *
 * Copyright (c) 2016 Brandon Sara (http://bsara.github.io)
 * Licensed under the CPOL-1.02 (https://github.com/bsara/stickytableheaders.js/blob/v0.2.0/LICENSE.md)
 */
!function(e,t){"function"==typeof define&&define.amd?define(t):"object"==typeof exports?module.exports=t(require,exports,module):e.STH=t()}(this,function(e,t,n){function r(e,t){function n(){y.disconnect(),L.disconnect(),s.helpers.removeEventListener(window,"resize",w),null!=this.$scrollable&&s.helpers.removeEventListener(this.$scrollable,"scroll",w),this.$table.classList.remove(s.constants.CSS_CLASS_NAME),null!=$&&$.classList.remove(s.constants.CSS_CLASS_NAME),y=void 0,L=void 0,N=void 0,T=void 0,$=void 0}function i(){return _}function l(e){_=e===!0}function o(){return N}function a(e){if(null==e)throw new ReferenceError("`$table` cannot be `null` or `undefined`.");N=e,N.classList.contains(s.constants.CSS_CLASS_NAME)||N.classList.add(s.constants.CSS_CLASS_NAME),v.call(this,N.querySelector("caption")),b.call(this,N.querySelector("thead"))}function c(){return T}function u(e){null==e?h.call(this):d.call(this,e),null==T&&d.call(this,f(this.$table))}function d(e){e!==T&&(null!=T&&(s.helpers.removeEventListener(T,"scroll",w),s.helpers.removeEventListener(window,"resize",w)),T=e,null!=T&&(s.helpers.addEventListener(T,"scroll",w),s.helpers.addEventListener(window,"resize",w)))}function h(){var e=this.$table.getAttribute(s.constants.SCROLLABLE_ELEMENT_SELECTOR_ATTR_NAME);null!=e&&"string"==typeof e&&e.trim()&&d.call(this,document.querySelector(e.trim()))}function f(e){if(null==e.parentNode)return e;var t=e.parentNode,n=getComputedStyle(t);switch(n.overflowY){case"auto":case"scroll":return t}return f(t)}function v(e){M=e}function b(e){$=e}function m(){if(null!=$){var e,t,n,r=null!=M,i=Math.floor(this.$scrollable.getBoundingClientRect().top),l=Math.floor(this.$table.getBoundingClientRect().top),o=getComputedStyle($),a=s.helpers.removeUnit(o.getPropertyValue("marginTop"));if(r&&!this.includeCaption&&(t=M.getBoundingClientRect(),e=getComputedStyle(M),n=s.helpers.removeUnit(e.getPropertyValue("marginBottom")),l+=Math.floor(t.height)+n),r&&this.includeCaption||(l+=a),i>=l){var c=$.getBoundingClientRect(),u=s.helpers.removeUnit(getComputedStyle(this.$table).getPropertyValue("border-left-width"));r&&this.includeCaption?(p(M,i,t.top,s.helpers.removeUnit(e.getPropertyValue("border-top-width"))),E(M,u,{left:s.helpers.removeUnit(e.getPropertyValue("border-left-width")),right:s.helpers.removeUnit(e.getPropertyValue("border-right-width"))}),$.style.top=t.top+t.height+n+a+"px"):p($,i,c.top,s.helpers.removeUnit(o.getPropertyValue("border-top-width"))),E($,u,{left:s.helpers.removeUnit(o.getPropertyValue("border-left-width")),right:s.helpers.removeUnit(o.getPropertyValue("border-right-width"))});for(var d=$.querySelectorAll("th"),h=this.$table.querySelectorAll("tbody > tr td"),f=null==h||0===h.length,v=100/d.length+"%",b=0;b<d.length;b++){var m=d[b];f?m.style.width=v:m.style.width=getComputedStyle(h[b]).getPropertyValue("width")}return void $.classList.add(s.constants.CSS_CLASS_NAME)}$.classList.remove(s.constants.CSS_CLASS_NAME),$.removeAttribute("style")}}function p(e,t,n,r){e.style.top=t-n+r+"px"}function E(e,t,n){e.style.left=n.left-t+"px",e.style.width="calc(100% + "+n.right+"px)"}function S(e){e.forEach(function(e){var t;for(t=0;t<e.addedNodes.length;t++)if("thead"===e.addedNodes[t].nodeName){b.call(this,e.addedNodes[t]);break}for(t=0;t<e.removedNodes.length;t++)if("thead"===e.removedNodes[t].nodeName){b.call(this,void 0);break}})}function g(e){e.forEach(function(e){e.attributeName===s.constants.SCROLLABLE_ELEMENT_SELECTOR_ATTR_NAME&&h.call(this)})}if(this.constructor!==r)return new r(e,t);var y,L,w,C,A,_,T,N,M,$;(function(){this.destroy=n.bind(this),Object.defineProperties(this,{includeCaption:{get:i,set:l},$scrollable:{get:c,set:u},$table:{get:o,set:a}}),w=m.bind(this),C=S.bind(this),A=g.bind(this),e=e||{},e instanceof HTMLElement&&(e={tableElement:e}),this.includeCaption=e.includeCaption,this.$table=e.tableElement,this.$scrollable=t||e.scrollableElement,y=new MutationObserver(C),y.observe(this.$table,{childList:!0}),L=new MutationObserver(A),L.observe(this.$table,{attributes:!0})}).call(this)}function i(){function e(){for(var e=document.querySelectorAll("table."+s.constants.CSS_CLASS_NAME),t=0;t<e.length;t++)this.add(e[t])}function t(){this.removeAll(),this.init()}function n(e,t){return c.indexOf(e)>-1?e:(l(e,t),c.push(e),e)}function r(e){var t=c.indexOf(e);return t>-1&&(o(e),c.splice(t,1)),e}function a(){for(var e=c.length;e>=0;e--)this.remove(e)}if(this.constructor!==i)return new i;var c;(function(){this.init=e,this.reinit=t,this.add=n,this.remove=r,this.removeAll=a,c=[]}).call(this)}function l(e,t){return a("tableElement",e),a("scrollableElement",t,!0),null!=e.stickyTableHeader?e:(e.stickyTableHeader=new r(e,t),e)}function o(e){return a("tableElement",e),null==e.stickyTableHeader?e:(e.stickyTableHeader.destroy(),delete e.stickyTableHeader,e)}function a(e,t,n){if(n!==!0&&null==t)throw new ReferenceError("`"+e+"` parameter cannot be `null` or `undefined`.");if(n===!0&&null!=t&&!(t instanceof HTMLElement))throw new TypeError("`"+e+"` parameter must be an `HTMLElement`, but a `"+t.constructor.name+"` was given.")}var s={constants:{CSS_CLASS_NAME:"sth-sticky",SCROLLABLE_ELEMENT_SELECTOR_ATTR_NAME:"data-sth-scrollable-selector"},helpers:{addEventListener:function(e,t,n){return e.attachEvent?void e.attachEvent("on"+t,n):void e.addEventListener(t,n,!1)},removeEventListener:function(e,t,n){return e.detachEvent?void e.detachEvent("on"+t):void e.removeEventListener(t,n)},removeUnit:function(e){if(null==e||"string"!=typeof e)throw new TypeError("`value` parameter must be a non-null/non-undefined string!");return""===e.trim()?0:Number(e.trim().replace(/[a-z]*$/i,""))}}};Object.freeze(s);var c=new i;return function(){var e=function(){c.init()};"loading"!==document.readyState?e():document.addEventListener?document.addEventListener("DOMContentLoaded",e):document.attachEvent("onreadystatechange",function(){"complete"===document.readyState&&e()})}(),function(){var e={};return Object.defineProperties(e,{disableStickyTableHeader:{configurable:!1,enumerable:!0,writable:!1,value:o},enableStickyTableHeader:{configurable:!1,enumerable:!0,writable:!1,value:l},manager:{configurable:!1,enumerable:!0,writable:!1,value:c},StickyTableHeader:{configurable:!1,enumerable:!0,writable:!1,value:r}}),e}()});