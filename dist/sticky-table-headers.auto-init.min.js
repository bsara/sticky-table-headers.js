/*!
 * sticky-table-headers.js (0.0.1)
 *
 * Copyright (c) 2015 Brandon Sara (http://bsara.github.io)
 * Licensed under the CPOL-1.02 (https://github.com/bsara/stickytableheaders.js/blob/v0.0.1/LICENSE.md)
 */
!function(e,t){"function"==typeof define&&define.amd?define(t):"object"==typeof exports?module.exports=t(require,exports,module):e.STH=t()}(this,function(e,t,n){var l={constants:{CSS_CLASS_NAME:"sth-sticky",SCROLLABLE_ELEMENT_SELECTOR_ATTR_NAME:"data-sth-scrollable-selector"},helpers:{addEventListener:function(e,t,n){return e.attachEvent?void e.attachEvent("on"+t,n):void e.addEventListener(t,n,!1)},removeEventListener:function(e,t,n){return e.detachEvent?void e.detachEvent("on"+t):void e.removeEventListener(t,n)},removeUnit:function(e){if("string"!=typeof e||null===e)throw new TypeError("`value` argument must be a non-null string!");return""===e.trim()?0:Number(e.trim().replace(/[a-z]*$/i,""))}}};Object.freeze(l);var r=function(){function e(s,d){if(null==s)throw new TypeError("`tableElement` is a required parameter!");return this.constructor!==e?new e(s,d):(Object.defineProperties(this,{_onChangeTableChildrenObserver:{configurable:!0,enumerable:!1,writable:!0,value:void 0},_onChangeTableScrollableElementSelectorObserver:{configurable:!0,enumerable:!1,writable:!0,value:void 0},_onChange:{configurable:!1,enumerable:!1,writable:!1,value:i.bind(this)}}),this.$table=s,this.$tableHeader=void 0,this.$scrollable=void 0,this.$table.classList.contains(l.constants.CSS_CLASS_NAME)||this.$table.classList.add(l.constants.CSS_CLASS_NAME),t.call(this,this.$table.querySelector("thead")),null==d?n.call(this):r.call(this,d),this._onChangeTableChildrenObserver=new MutationObserver(a.bind(this)),this._onChangeTableChildrenObserver.observe(this.$table,{childList:!0}),this._onChangeTableScrollableElementSelectorObserver=new MutationObserver(o.bind(this)),void this._onChangeTableScrollableElementSelectorObserver.observe(this.$table,{attributes:!0}))}e.prototype.destroy=function(){this._onChangeTableChildrenObserver.disconnect(),this._onChangeTableScrollableElementSelectorObserver.disconnect(),l.helpers.removeEventListener(window,"resize",this._onChange),null!=this.$scrollable&&l.helpers.removeEventListener(this.$scrollable,"scroll",this._onChange),this.$table.classList.remove(l.constants.CSS_CLASS_NAME),null!=this.$tableHeader&&this.$tableHeader.classList.remove(l.constants.CSS_CLASS_NAME),delete this.$table,delete this.$tableHeader,delete this.$scrollable,delete this._onChangeTableChildrenObserver,delete this._onChangeTableScrollableElementSelectorObserver,delete this._onChange};var t=function(e){this.$tableHeader=e,null!=this.$tableHeader},n=function(){var e=this.$table.getAttribute(l.constants.SCROLLABLE_ELEMENT_SELECTOR_ATTR_NAME);null!=e&&"string"==typeof e&&e.trim()&&r.call(this,document.querySelector(e.trim())),null==this.$scrollable&&r.call(this,this.$table.parentNode)},r=function(e){return this.$scrollable=e,null!=this.$scrollable?(l.helpers.addEventListener(this.$scrollable,"scroll",this._onChange),void l.helpers.addEventListener(window,"resize",this._onChange)):void l.helpers.removeEventListener(window,"resize",this._onChange)},i=function(){if(null!=this.$tableHeader){var e=this.$scrollable.getBoundingClientRect().top;if(this.$table.getBoundingClientRect().top<e){var t=this.$table.getBoundingClientRect(),n=l.helpers.removeUnit(window.getComputedStyle(this.$table,null).getPropertyValue("border-left-width")),r=window.getComputedStyle(this.$tableHeader,null),i=l.helpers.removeUnit(r.getPropertyValue("border-top-width")),a=l.helpers.removeUnit(r.getPropertyValue("border-left-width")),o=l.helpers.removeUnit(r.getPropertyValue("border-right-width"));this.$tableHeader.style.top=e-t.top+i+"px",this.$tableHeader.style.left=a-n+"px",this.$tableHeader.style.width="calc(100% + "+o+"px)";for(var s=this.$tableHeader.querySelectorAll("th"),d=this.$table.querySelectorAll("tbody > tr td"),h=null==d||0===d.length,c=100/s.length+"%",b=0;b<s.length;b++){var u=s[b];h?u.style.width=c:u.style.width=window.getComputedStyle(d[b],void 0).getPropertyValue("width")}return void this.$tableHeader.classList.add(l.constants.CSS_CLASS_NAME)}this.$tableHeader.classList.remove(l.constants.CSS_CLASS_NAME),this.$tableHeader.removeAttribute("style")}},a=function(e){e.forEach(function(e){var n;for(n=0;n<e.addedNodes.length;n++)if("thead"===e.addedNodes[n].nodeName){t.call(this,e.addedNodes[n]);break}for(n=0;n<e.removedNodes.length;n++)if("thead"===e.removedNodes[n].nodeName){t.call(this,void 0);break}})},o=function(e){e.forEach(function(e){e.attributeName===l.constants.SCROLLABLE_ELEMENT_SELECTOR_ATTR_NAME&&n.call(this)})};return e}(),i=function(){function e(){return this.constructor!==e?new e:void Object.defineProperties(this,{_stickyTableHeaders:{configurable:!0,enumerable:!1,writable:!0,value:[]},_tableElements:{configurable:!0,enumerable:!1,writable:!0,value:[]}})}e.prototype.init=function(){for(var e=document.querySelectorAll("table."+l.constants.CSS_CLASS_NAME),n=0;n<e.length;n++)t.call(this,e[n])},e.prototype.reinit=function(){this.removeAll(),this.init()},e.prototype.removeAll=function(){for(var e=this._tableElements.length;e>=0;e--)n.call(this,e)},e.prototype.addStickyHeaderToTable=function(e,n){return this._tableElements.indexOf(e)>-1?e:(t.call(this,e,n),e)},e.prototype.removeStickyHeaderFromTable=function(e){var t=this._tableElements.indexOf(e);t>-1&&n.call(this,t)};var t=function(e,t){this._stickyTableHeaders.push(new r(e,t)),this._tableElements.push(e)},n=function(e){this._stickyTableHeaders.splice(e,1)[0].destroy(),this._tableElements.splice(e,1)};return e}(),a=new i;return function(){var e=function(){a.init()};"loading"!==document.readyState?e():document.addEventListener?document.addEventListener("DOMContentLoaded",e):document.attachEvent("onreadystatechange",function(){"complete"===document.readyState&&e()})}(),function(){var e={};return Object.defineProperties(e,{manager:{configurable:!1,enumerable:!0,writable:!1,value:new i},StickyTableHeader:{configurable:!1,enumerable:!0,writable:!1,value:r}}),e}()});